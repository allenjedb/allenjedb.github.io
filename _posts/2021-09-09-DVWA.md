---
title: DVWA
date: 2021-09-09
categories:
  - Writeup
tags:
  - DVWA
  - Writeup
  
---
<p><img src="/assets/images/dvwa.png" alt="" /></p>

<p>Damn Vulnerable Web App (DVWA) is a PHP/MySQL web application that is damn vulnerable. Its main goals are to be an aid for security professionals to test their skills and tools in a legal environment, help web developers better understand the processes of securing web applications and aid teachers/students to teach/learn web application security in a class room environment.</p>

<p>Let's test our OWASP TOP 10 skills with DVWA</p>

<h1>Bruteforcing</h1>
<p>Low</p>

<p>In the Bruteforcing section we can see a normal login page<img src="/assets/images/dvwa/bruteforcing/1.png" alt="" />we can try entering any cred and see how it will react, let's try admin:admin<img src="/assets/images/dvwa/bruteforcing/1-2.png" alt="" />it gives out an error message "Username and/or password incorrect."</p>

<p>Now let's capture the request with a tool called <a href="https://portswigger.net/burp/communitydownload">BurpSuite</a>- BurpSuite is a proxy-based tool used to evaluate the security of web-based applications and do hands-on testing. </p>

<p>Before we continue using BurpSuite we need to setup our web browser's proxy so that BurpSuite can intercept all the request that we want. For this we will use an add-on called <a href="https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/">FoxyProxy</a> to make changing our proxy settings easier. Now add a proxy settings with in FoxyProxy as follows <img src="/assets/images/dvwa/bruteforcing/1-3.png" alt="" /> - Select the proxy that you created and now we're ready to intercept our first request!</p>

<p>Login again using any creds - this time Burp will intercept the request and you should see the request in the Proxy tab<img src="/assets/images/dvwa/bruteforcing/2.png" alt="" /> - here we can see that we sent a GET request for /vulnerabilities/brute/?username=admi&password=admin&Login=Login to our DVWA host which is 192.168.56.103 on my case.</p>

<p>We can Bruteforce this using the Intruder function of Burp - right click on the request and send the request to Intruder<img src="/assets/images/dvwa/bruteforcing/3.png" alt="" /><br>Now that we're in the intruder click the clear button to remove the highlighted payloads - these payloads are the ones that we can bruteforce for this example we will use the Attack Type called Sniper. Highlight the password and click add$.<br><img src="/assets/images/dvwa/bruteforcing/4.png" alt="" />You will notice that the password part will get highlighted this means that it is selected for bruteforcing - now click the payloads tab<br><img src="/assets/images/dvwa/bruteforcing/5.png" alt="" />Here we can load out our wordlists that Burp will use to bruteforce our selected payload, in our case the password section.</p>

<p>I will use the worldlist probable-v2-top1575 from the <a href="https://github.com/danielmiessler/SecLists"> Seclists</a> collection. After loading the wordlist we can now proceed to bruteforcing - Click Attack. Sort the results according to length and from here you will see one entry with different value which is 5007 for password.<br><img src="/assets/images/dvwa/bruteforcing/6.png" alt="" /></p>

<p>if we try to login using the result we will get the following<img src="/assets/images/dvwa/bruteforcing/7.png" alt="" /> If we try to inspect element we can see the location of the image<img src="/assets/images/dvwa/bruteforcing/8.png" alt="" /><br>And after browsing to the directory we will see the other probable users.<img src="/assets/images/dvwa/bruteforcing/9.png" alt="" /></p>

<p>Now we can do the same thing for the other probable users. We can do this one at a time by editing the username field on our request (changing the admin to another user) and then proceeding like before or we can use the Cluster Bomb attack type. To do this clear the payloads, then add the username and password field again.<img src="/assets/images/dvwa/bruteforcing/9-1.png" alt="" /><br>Now this time in the payloads tab, we can set 2 payloads the first one for the usernames and the second for the password. I have created a new file that contains all the possible usernames.<img src="/assets/images/dvwa/bruteforcing/10.png" alt="" /><br>Now I'll set this as my first payload<img src="/assets/images/dvwa/bruteforcing/15.png" alt="" /><br>And for the second I'll still use the worldlist probable-v2-top1575</p>

<p>After some time we got the result of the attack.<img src="/assets/images/dvwa/bruteforcing/16.png" alt="" /><br></p>

<p>We can also use Hydra to bruteforce the web login but we won't deep dive to it for now but to do this we can use the following command</p>

<p style="font-size:15px">hydra 192.168.56.103 -L "usernames.dvwa" -P "SecLists/Passwords/xato-net-10-million-passwords.txt" http-get-form  "/vulnerabilities/brute/:username=^USER^&password=^PASS^&Login=Login:F=Username and/or password incorrect:H=Cookie: PHPSESSID=du7ts72sjgglbh74h9gdps1216; security=low"</p>

<ul>
  <li>-L is for a text file that contains the usernames if you want to use a specific username you can use lowercase instead -l</li>
  <li>-P is the same for username but for passwords here we used the wordlists, you can also use lowercase to use specific password -p</li>
  <li>http-get-form is used this time cause the remember from the request that we intercepted we are sending GET request, we also used http as DVWA is using http</li>
  <li>:F= is required for http-get-form this tells hydra to check for this failure message so hydra can differentiate the real credentials, we can also use the opposite which is :S meaning we have to provide a successful message instead</li>
  <li>:H=Cookie: this is needed as we are already logged in as admin within DVWA(initial login page)</li>
</ul>

<h1>Command Execution</h1>
<p>Low</p>

<p>For this section we will learn about Command Execution, Command injection is an attack in which the goal is execution of arbitrary commands on the host operating system via a vulnerable application. Command injection attacks are possible when an application passes unsafe user supplied data (forms, cookies, HTTP headers etc.) to a system shell.

<p>In this section we can see a single input box that's asking for an IP Address<img src="/assets/images/dvwa/CE/1.png" alt="" /><br>Looks like it is a ping tool. Let's try supplying it with its own IP Address<img src="/assets/images/dvwa/CE/2.png" alt="" /><br>It returns a normal ping output. Let's try my Host IP <img src="/assets/images/dvwa/CE/3.png" alt="" /><br>Let's see what's the output for an unknown IP Address<img src="/assets/images/dvwa/CE/1.png" alt="" /><br>It didn't return any output. I've tried giving it a normal bash command like ls but the same no output.</p>

<p>From this we can conclude that the IP address that we supply is getting treated like a variable and being added to the ping command so it results like ping $IP and then -c4 cause it returns 4 replies. So what happens if we try chaining a command? In Linux we can chain a command using ; So for example ping 127.0.0.1; ls will ping 127.0.0.1 and then execute the list command.<br><img src="/assets/images/dvwa/CE/4.png" alt="" /><br>And the output is <img src="/assets/images/dvwa/CE/5.png" alt="" /><br>As we can see after the ping it showed as the contents of the directory which is help, index.php, source.</p>



